<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>{% block title %}{% endblock %}</title>
    {% load static %}
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Favicons -->
    
    <link href="{% static 'core/img/milogo.jpg' %}" rel="icon" >
    
<!-- Fuente Poppins -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <script src="{% static 'core/js/main.js' %}"></script>
    {% if request.path != '/account/register/' and request.path != '/account/register_alumnos/' and request.path != '/account/login/' %}
    <script src="{% static 'core/js/cierreSesion.js' %}"></script>
  {% endif %}
    <script src="{% static 'core/js/form_medico.js' %}"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&family=Poppins:wght@100;200;300;400;500;600;700;800;900&family=Raleway:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vendor CSS Files -->
    <link href="{% static 'core/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'core/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
    <link href="{% static 'core/vendor/aos/aos.css' %}" rel="stylesheet">
    <link href="{% static 'core/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
    <link href="{% static 'core/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Main CSS File -->
    <link href="{% static 'core/css/main.css' %}" rel="stylesheet">
</head>

<body class="index-page">
  {% if request.path != '/account/login/' and request.path != '/account/register/' and request.path != '/account/register_alumnos/' %}
    <header id="header" class="header d-flex align-items-center sticky-top">
        <div class="container-fluid position-relative d-flex align-items-center justify-content-between">
              
                <a href="{% url 'home' %}" class="logo d-flex align-items-center me-auto me-xl-0">
                    <img src="{% static 'core/img/milogo3.png' %}" alt="Logo"  >
                    <h1 class="sitename" >CHECKEATE</h1>    
                </a>
           
                <nav id="navmenu" class="navbar navbar-expand-lg navbar-light bg-white">
                    <div class="container-fluid">
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNav">
                            <ul class="navbar-nav ms-auto align-items-center">
                                {% if request.path != '/account/login/' %}
                                    {% if user.is_authenticated %}
                                        <li class="nav-item me-3">
                                            <a href="{% url 'perfil' %}" class="nav-link active">Perfil</a>
                                        </li>
                                        <li class="nav-item me-3">
                                            <button type="button" class="btn btn-link nav-link" data-bs-toggle="modal" data-bs-target="#logoutModal">
                                                Salir
                                            </button>
                                        </li>
                                        <!-- Contenedor para el nombre y apellido -->
                                        <li class="nav-item">
                                            <span class="navbar-text fw-bold">
                                                {{ profile.nombre }} {{ profile.apellido }}
                                            </span>
                                        </li>
                                        <!-- Menú Condicional según el tipo de perfil -->
                                        {% if profile.rol == 'jugador' %}
                                            <li class="nav-item me-3">
                                                <a href="{% url 'menu_jugador' %}" class="nav-link"></a>
                                            </li>
                                        {% endif %}
                                    {% else %}
                                        <li class="nav-item me-3">
                                            <a href="{% url 'login' %}" class="nav-link">Iniciar Sesión</a>
                                        </li>
                                       
                                    {% endif %}
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                </nav>
                

        </div>
    </header>
    {% endif %}
    {% block content %}{% endblock %}
<!-- ✅ Chatbot Flotante estilo WhatsApp con flujo secuencial -->

<!-- Botón flotante -->
<div id="chatbot-boton" onclick="abrirChat()" class="btn btn-success rounded-circle d-flex justify-content-center align-items-center" style="position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; z-index: 1050;">
    <i class="bi bi-chat-dots" style="font-size: 1.5rem;"></i>
  </div>
  
  <!-- Contenedor del Chatbot -->
  <div id="chatbot-contenedor" class="card shadow-sm" style="position: fixed; bottom: 90px; right: 20px; width: 320px; display: none; z-index: 1050;">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <span>¿Necesitás ayuda?</span>
      <button class="btn-close btn-close-white" onclick="cerrarChat()"></button>
    </div>
    <div class="card-body">
      <!-- Paso 1: Pregunta inicial -->
      <div id="paso1">
        <p>¿Necesitás ayuda?</p>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-primary btn-sm w-100" onclick="siguientePaso(2)">Sí</button>
          <button class="btn btn-outline-secondary btn-sm w-100" onclick="cerrarChat()">No</button>
        </div>
      </div>
  
      <!-- Paso 2: Selección de tipo de usuario -->
      <div id="paso2" style="display: none;">
        <p>¿Sos Tutor o Jugador?</p>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-info btn-sm w-100" onclick="mostrarPreguntas('tutor')">Tutor</button>
          <button class="btn btn-outline-success btn-sm w-100" onclick="mostrarPreguntas('jugador')">Jugador</button>
        </div>
      </div>
  
      <!-- Paso 3: Lista de preguntas -->
      <div id="preguntas-container" style="display: none;">
        <p class="fw-bold" id="titulo-preguntas"></p>
        <ul class="list-group list-group-flush" id="lista-preguntas"></ul>
        <div id="respuesta" class="alert alert-info mt-3 d-none"></div>
      </div>
    </div>
  </div>
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  
  <script>
    const preguntasTutor = [
      { q: "¿Cómo creo un nuevo CUS?", r: "Desde el panel de tutor, seleccioná al estudiante y hacé clic en 'Nuevo CUS'." },
      { q: "¿Qué pasa si el CUS está vencido?", r: "Podés cargar uno nuevo, y el sistema traerá los datos anteriores." },
      { q: "¿Dónde veo los antecedentes cargados?", r: "En la ficha del estudiante, sección 'Antecedentes Médicos'." },
      { q: "¿Puedo actualizar antecedentes?", r: "Sí, solo si el CUS está vencido. Se habilita automáticamente." },
      { q: "¿Qué estudios puedo cargar?", r: "Laboratorio, oftalmológico, torax, entre otros." },
      { q: "¿Cuántas actualizaciones tiene el CUS?", r: "Hasta 5 actualizaciones. Luego se marca como vencido." },
      { q: "¿Puedo ver el PDF del CUS?", r: "Sí, una vez aprobado podés descargarlo." },
      { q: "¿Qué pasa si falta un formulario?", r: "No se puede guardar el CUS hasta completar todos los formularios." },
      { q: "¿Puedo contactar al médico?", r: "Sí, desde el panel del estudiante verás los datos del médico asignado." },
      { q: "¿Qué hago si el CUS fue rechazado?", r: "Revisá los comentarios del rechazo y corregilo para reenviarlo." }
    ];
  
    const preguntasJugador = [
      { q: "¿Cómo subo mis estudios médicos?", r: "Desde tu panel, clic en 'Cargar estudios' y adjuntá los archivos." },
      { q: "¿Qué pasa si me rechazan un estudio?", r: "El médico dejará un comentario. Subí una nueva versión." },
      { q: "¿Cuánto dura un apto físico?", r: "Hasta el 31 de diciembre del año en curso." },
      { q: "¿Dónde veo si mi apto fue aprobado?", r: "En tu panel, el estado se muestra junto al nombre del torneo." },
      { q: "¿Puedo descargar mi apto físico?", r: "Sí, una vez aprobado podés descargarlo como PDF." },
      { q: "¿Qué estudios son obligatorios?", r: "Depende del torneo, usualmente laboratorio y cardiovascular." },
      { q: "¿Puedo usar el mismo apto para varios torneos?", r: "Sí, si está vigente y es aceptado por cada organización." },
      { q: "¿Quién ve mis estudios?", r: "Solo médicos autorizados y organizadores del torneo." },
      { q: "¿Puedo subir estudios desde el celular?", r: "Sí, la plataforma es compatible con dispositivos móviles." },
      { q: "¿Qué pasa si tengo varias fichas en curso?", r: "Podés gestionarlas por separado, cada una vinculada a su torneo." }
    ];
  
    function abrirChat() {
      document.getElementById("chatbot-contenedor").style.display = "block";
      document.getElementById("chatbot-boton").style.display = "none";
    }
  
    function cerrarChat() {
      document.getElementById("chatbot-contenedor").style.display = "none";
      document.getElementById("chatbot-boton").style.display = "flex";
      document.getElementById("paso1").style.display = "block";
      document.getElementById("paso2").style.display = "none";
      document.getElementById("preguntas-container").style.display = "none";
      document.getElementById("respuesta").classList.add("d-none");
    }
  
    function siguientePaso(paso) {
      document.getElementById("paso1").style.display = paso === 1 ? "block" : "none";
      document.getElementById("paso2").style.display = paso === 2 ? "block" : "none";
      document.getElementById("preguntas-container").style.display = "none";
      document.getElementById("respuesta").classList.add("d-none");
    }
  
    function mostrarPreguntas(tipo) {
      const preguntas = tipo === 'tutor' ? preguntasTutor : preguntasJugador;
      const lista = document.getElementById("lista-preguntas");
      const titulo = document.getElementById("titulo-preguntas");
      const paso1 = document.getElementById("paso1");
      const paso2 = document.getElementById("paso2");
      const preguntasContainer = document.getElementById("preguntas-container");
  
      if (!lista || !titulo || !paso1 || !paso2 || !preguntasContainer) {
        console.error("❌ No se encuentran uno o más elementos del DOM necesarios para mostrar las preguntas.");
        return;
      }
  
      lista.innerHTML = "";
      preguntas.forEach((item) => {
        const li = document.createElement("li");
        li.className = "list-group-item list-group-item-action";
        li.style.cursor = "pointer";
        li.textContent = item.q;
        li.onclick = () => mostrarRespuesta(item.r);
        lista.appendChild(li);
      });
  
      titulo.textContent = tipo === 'tutor' ? "Preguntas frecuentes para Tutores" : "Preguntas frecuentes para Jugadores";
  
      paso1.style.display = "none";
      paso2.style.display = "none";
      preguntasContainer.style.display = "block";
    }
  
    function mostrarRespuesta(texto) {
      const div = document.getElementById("respuesta");
      div.textContent = texto;
      div.classList.remove("d-none");
    }
  </script>
  
    {% block publicidad %}{% endblock %}
    {% block landingPage %} {% endblock %}
  
    {% block footer %}{% endblock %}
    
      
    <!-- Modal de confirmación de cierre de sesión -->
    <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="logoutModalLabel">Cerrar Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    ¿Estás seguro de que deseas cerrar sesión?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <form method="POST" action="{% url 'logout' %}" class="d-inline" id="logout-form">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Cerrar Sesión</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Vendor JS Files -->
    <script src="{% static 'core/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'core/vendor/aos/aos.js'%}"></script>
    <script src="{% static 'core/vendor/glightbox/js/glightbox.min.js'%}"></script>
    <script src="{% static 'core/vendor/swiper/swiper-bundle.min.js'%}"></script>
 
    <!-- Main JS File -->

</body>

</html>
