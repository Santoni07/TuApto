<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Registro</title>
    
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Favicons -->

    <link href="/static/core/img/milogo.jpg" rel="icon" >

<!-- Fuente Poppins -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <script src="/static/core/js/main.js"></script>
    
    <script src="/static/core/js/form_medico.js"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&family=Poppins:wght@100;200;300;400;500;600;700;800;900&family=Raleway:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vendor CSS Files -->
    <link href="/static/core/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/core/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/core/vendor/aos/aos.css" rel="stylesheet">
    <link href="/static/core/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="/static/core/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Main CSS File -->
    <link href="/static/core/css/main.css" rel="stylesheet">
</head>

<body class="index-page">
  
    
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container-fluid vh-100 d-flex align-items-center justify-content-center m-0 p-0">
    <div class="row w-100 h-100 g-0">
        <div class="col-md-7 d-none d-md-flex align-items-center justify-content-center bg-light h-100">
            <img src="/static/core/img/login.jpeg" alt="Aptos m√©dicos" class="img-fluid w-100 h-100 object-fit-cover opacity-75">
        </div>

        <div class="col-12 col-md-5 d-flex flex-column align-items-center justify-content-center border-start bg-white h-100 p-3 p-md-4">
            <div class="card p-3 p-md-4 shadow-lg w-100" style="max-height: 80vh; border-radius: 10px; border: none; max-width: 80%; overflow-y: auto;">
                <div class="text-center">
                    <img src="/static/core/img/milogo3.png" alt="Logo" style="width: 90px;">
                    <h1 class="mt-2">CHECKEATE</h1>
                </div>
                <div class="card-header text-center bg-white border-0">
                    <h4 class="fw-bold">¬°Reg√≠strate ahora!</h4>
                    <p class="text-muted small">Completa los datos para crear tu cuenta y gestionar tus <strong>CUS ONLINE</strong>.</p>
                    <p class="text-muted small">Vamos a verificar tu Email.</p>
                    <div id="usuarioExistenteMensaje" class="text-success small" style="display:none;"></div>
                </div>

                <div class="card-body">
                    
                        
                        <form method="post" action="/account/register_alumnos/" id="registroForm" novalidate>
                            <input type="hidden" name="csrfmiddlewaretoken" value="y38V7LGifoZahXk9PecmHOA6lfPSBpxpG64MTrMERbLfWd74ImreqUcdDdPv55ji">

                            <div class="mb-2 input-field">
                                <label class="form-label fw-bold">Email</label>
                                <div class="input-group">
                                    <input type="email" name="email" maxlength="254" value="" class="form-control" required id="id_email">
                                    <button type="button" class="btn btn-outline-secondary" onclick="verificarEmail()">Verificar</button>
                                </div>
                                
                            </div>

                            <div id="camposExtra" style="display:none;">
                                <div class="mb-2 input-field">
                                    <label class="form-label fw-bold">Nombre</label>
                                    <input type="text" name="nombre" maxlength="30" class="form-control" id="id_nombre">
                                </div>
                                <div class="mb-2 input-field">
                                    <label class="form-label fw-bold">Apellido</label>
                                    <input type="text" name="apellido" maxlength="30" class="form-control" id="id_apellido">
                                </div>
                                <div class="mb-2 input-field">
                                    <label class="form-label fw-bold">Dni</label>
                                    <input type="text" name="dni" maxlength="15" class="form-control" id="id_dni">
                                    <div id="dniExistenteMensaje" class="text-danger small mt-1" style="display: none;"></div>
                                </div>
                                <div class="mb-2 input-field">
                                    <label class="form-label fw-bold">Fecha de Nacimiento</label>
                                    <input type="date" name="fecha_nacimiento" class="form-control form-control" required id="id_fecha_nacimiento">
                                </div>
                                <div class="mb-2 input-field">
                                    <label class="form-label fw-bold">Repite Contrase√±a</label>
                                    <div class="input-group">
                                        <input type="password" name="password2" class="form-control" required id="id_password2">
                                        <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('id_password2', 'togglePasswordIcon2')">
                                            <i id="togglePasswordIcon2" class="fa fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-2 input-field" id="campoPassword1" style="display:none;">
                                <label class="form-label fw-bold">Contrase√±a</label>
                                <div class="input-group">
                                    <input type="password" name="password1" required class="form-control" id="id_password1">
                                    <button type="button" class="btn btn-outline-secondary" onclick="togglePassword('id_password1', 'togglePasswordIcon1')">
                                        <i id="togglePasswordIcon1" class="fa fa-eye"></i>
                                    </button>
                                </div>
                                
                            </div>

                            <div class="mb-2 form-check">
                                <input type="checkbox" id="termsCheckbox" class="form-check-input">
                                <label for="termsCheckbox" class="form-check-label">Acepto los <a href="/account/terminos_condiciones/" style="text-decoration: none;">T√©rminos y Condiciones</a></label>
                                <div id="termsError" class="text-danger small d-none">Debe aceptar los t√©rminos y condiciones</div>
                            </div>

                            <div class="d-grid mt-2">
                                <input type="submit" value="Crear cuenta" class="btn btn-primary w-100">
                            </div>
                        </form>

                        <div class="mt-3 text-center">
                            <p>¬øYa tienes una cuenta? <a href="/account/login/" style="text-decoration: none;">Inici√° sesi√≥n aqu√≠</a></p>
                            <a href="/" style="text-decoration: none;">Volver al Inicio</a>
                        </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function verificarEmail() {
    const emailInput = document.querySelector('input[name="email"]');
    const email = emailInput.value;
    const camposExtra = document.getElementById("camposExtra");
    const password1 = document.getElementById("campoPassword1");
    const mensaje = document.getElementById("usuarioExistenteMensaje");

    if (!email) return;

    fetch(`/account/verificar-email/?email=${email}`)
        .then(response => response.json())
        .then(data => {
            if (data.existe) {
                camposExtra.style.display = "none";
                password1.style.display = "block";
                mensaje.style.display = "block";
                mensaje.textContent = "Este correo ya est√° registrado. Ingres√° tu contrase√±a para gestionar tu cuenta.";
            } else {
                camposExtra.style.display = "block";
                password1.style.display = "block";
                mensaje.style.display = "none";
            }
        });
}

function togglePassword(fieldId, iconId) {
    const passwordField = document.getElementById(fieldId);
    const icon = document.getElementById(iconId);

    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        passwordField.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}


    document.addEventListener("DOMContentLoaded", function () {
        console.log("‚úÖ DOM completamente cargado");

        const form = document.getElementById("registroForm");
        const checkbox = document.getElementById("termsCheckbox");
        const error = document.getElementById("termsError");

        if (form) {
            form.addEventListener("submit", function (e) {
                console.log("üß™ Validando checkbox...");
                console.log("‚û°Ô∏è Checkbox marcado:", checkbox.checked);

                if (!checkbox.checked) {
                    error.classList.remove("d-none");
                    e.preventDefault();
                } else {
                    error.classList.add("d-none");
                }
            });
        }
    });

</script>
    <script>
function verificarDni() {
    const dniInput = document.querySelector('input[name="dni"]');
    const dni = dniInput.value;
    const dniMensaje = document.getElementById("dniExistenteMensaje");

    if (!dni) return;

    fetch(`/account/verificar-dni/?dni=${dni}`)
        .then(response => response.json())
        .then(data => {
            if (data.existe) {
                dniMensaje.style.display = "block";
                dniMensaje.textContent = "Este DNI ya est√° registrado.";
            } else {
                dniMensaje.style.display = "none";
                dniMensaje.textContent = "";
            }
        });
}
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const dniInput = document.querySelector('input[name="dni"]');
    dniInput.addEventListener("blur", verificarDni);
});
</script>

<style>
@media (min-width: 768px) {
    .input-field {
        margin-bottom: 0.5rem;
    }
}

@media (max-width: 767px) {
    .input-field {
        margin-bottom: 1.5rem;
    }
    .card {
        max-height: 90vh;
        overflow-y: auto;
    }
}
</style>

<!-- ‚úÖ Chatbot Flotante estilo WhatsApp con flujo secuencial -->

<!-- Bot√≥n flotante -->
<div id="chatbot-boton" onclick="abrirChat()" class="btn btn-success rounded-circle d-flex justify-content-center align-items-center" style="position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; z-index: 1050;">
    <i class="bi bi-chat-dots" style="font-size: 1.5rem;"></i>
  </div>

  <!-- Contenedor del Chatbot -->
  <div id="chatbot-contenedor" class="card shadow-sm" style="position: fixed; bottom: 90px; right: 20px; width: 320px; display: none; z-index: 1050;">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <span>¬øNecesit√°s ayuda?</span>
      <button class="btn-close btn-close-white" onclick="cerrarChat()"></button>
    </div>
    <div class="card-body">
      <!-- Paso 1: Pregunta inicial -->
      <div id="paso1">
        <p>¬øNecesit√°s ayuda?</p>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-primary btn-sm w-100" onclick="siguientePaso(2)">S√≠</button>
          <button class="btn btn-outline-secondary btn-sm w-100" onclick="cerrarChat()">No</button>
        </div>
      </div>

      <!-- Paso 2: Selecci√≥n de tipo de usuario -->
      <div id="paso2" style="display: none;">
        <p>¬øSos Tutor o Jugador?</p>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-info btn-sm w-100" onclick="mostrarPreguntas('tutor')">Tutor</button>
          <button class="btn btn-outline-success btn-sm w-100" onclick="mostrarPreguntas('jugador')">Jugador</button>
        </div>
      </div>

      <!-- Paso 3: Lista de preguntas -->
      <div id="preguntas-container" style="display: none;">
        <p class="fw-bold" id="titulo-preguntas"></p>
        <ul class="list-group list-group-flush" id="lista-preguntas"></ul>
        <div id="respuesta" class="alert alert-info mt-3 d-none"></div>
      </div>
    </div>
  </div>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<script>
  const preguntasTutor = [
    { q: "¬øC√≥mo creo un nuevo CUS?", r: "Desde el panel de tutor, seleccion√° al estudiante y hac√© clic en 'Nuevo CUS'." },
    { q: "¬øQu√© pasa si el CUS est√° vencido?", r: "Pod√©s cargar uno nuevo, y el sistema traer√° los datos anteriores." },
    { q: "¬øD√≥nde veo los antecedentes cargados?", r: "En la ficha del estudiante, secci√≥n 'Antecedentes M√©dicos'." },
    { q: "¬øPuedo actualizar antecedentes?", r: "S√≠, solo si el CUS est√° vencido. Se habilita autom√°ticamente." },
    { q: "¬øQu√© estudios puedo cargar?", r: "Laboratorio, oftalmol√≥gico, torax, entre otros." },
    { q: "¬øCu√°ntas actualizaciones tiene el CUS?", r: "Hasta 5 actualizaciones. Luego se marca como vencido." },
    { q: "¬øPuedo ver el PDF del CUS?", r: "S√≠, una vez aprobado pod√©s descargarlo." },
    { q: "¬øQu√© pasa si falta un formulario?", r: "No se puede guardar el CUS hasta completar todos los formularios." },
    { q: "¬øPuedo contactar al m√©dico?", r: "S√≠, desde el panel del estudiante ver√°s los datos del m√©dico asignado." },
    { q: "¬øQu√© hago si el CUS fue rechazado?", r: "Revis√° los comentarios del rechazo y corregilo para reenviarlo." }
  ];

  const preguntasJugador = [
    { q: "¬øC√≥mo subo mis estudios m√©dicos?", r: "Desde tu panel, clic en 'Cargar estudios' y adjunt√° los archivos." },
    { q: "¬øQu√© pasa si me rechazan un estudio?", r: "El m√©dico dejar√° un comentario. Sub√≠ una nueva versi√≥n." },
    { q: "¬øCu√°nto dura un apto f√≠sico?", r: "Hasta el 31 de diciembre del a√±o en curso." },
    { q: "¬øD√≥nde veo si mi apto fue aprobado?", r: "En tu panel, el estado se muestra junto al nombre del torneo." },
    { q: "¬øPuedo descargar mi apto f√≠sico?", r: "S√≠, una vez aprobado pod√©s descargarlo como PDF." },
    { q: "¬øQu√© estudios son obligatorios?", r: "Depende del torneo, usualmente laboratorio y cardiovascular." },
    { q: "¬øPuedo usar el mismo apto para varios torneos?", r: "S√≠, si est√° vigente y es aceptado por cada organizaci√≥n." },
    { q: "¬øQui√©n ve mis estudios?", r: "Solo m√©dicos autorizados y organizadores del torneo." },
    { q: "¬øPuedo subir estudios desde el celular?", r: "S√≠, la plataforma es compatible con dispositivos m√≥viles." },
    { q: "¬øQu√© pasa si tengo varias fichas en curso?", r: "Pod√©s gestionarlas por separado, cada una vinculada a su torneo." }
  ];

  const preguntasMedico = [
    { q: "¬øC√≥mo apruebo un apto?", r: "Busca el jugador, hace click en cargar y complet√° todos los estudios requeridos. Luego en el certificado selecciona 'Aprobar' y guarda el mismo." },
    { q: "¬øC√≥mo veo si un apto ya fue aprobado anteriormente?",r: "Desde el panel de jugadores, busc√° al paciente y hac√© clic en 'Ver ficha'. Si fue aprobado, ver√°s la fecha y el estado final."},
    { q: "¬øQu√© debo revisar antes de aprobar un CUS?",r: "Verific√° que todos los formularios est√©n completos, firmados y sin observaciones pendientes."},
    { q: "¬øQu√© hago si el jugador no tiene antecedentes cargados?", r: "podras ver al jugador en el listado pero no podras realizar ninguna accion hasta que el jugador cargue los antecedentes" },
    { q: "¬øPuedo agregar comentarios al rechazo?", r: "S√≠, antes de rechazar un CUS o apto, pod√©s dejar comentarios en el campo de observaciones explicando los motivos." },
    { q: "¬øQu√© pasa si faltan estudios?", r: "No podr√°s aprobar hasta que est√©n todos los formularios completos." },
    { q: "¬øQu√© hago si el certificado de matr√≠cula es inv√°lido?", r: "Verific√° el QR autom√°ticamente al subir el documento. Si no es v√°lido, solicit√° uno nuevo." },
    { q: "¬øQu√© pasa si el jugador tiene dos registros activos?", r: "Pod√©s ver ambos registros y aprobarlos individualmente. El sistema mantiene separados los torneos." },
    { q: "¬øPuedo validar estudios desde el celular?", r: "S√≠, el sistema est√° optimizado para dispositivos m√≥viles, aunque se recomienda el uso de escritorio para revisar documentos." },

  ];

  function esVistaMedico() {
    const path = window.location.pathname;
    const rutasMedico = [
      "/medico/medico_home/",
      "/medico/cus_home/",
      "/medico/seleccionar_apto/",
      "/medico/documentacion/cargar/",
      "/medico/contrato/",
    ];
    return (
      rutasMedico.some(r => path.startsWith(r)) ||
      path.includes("registro_medico_update") ||
      path.includes("/cus/")
    );
  }

  function abrirChat() {
    document.getElementById("chatbot-contenedor").style.display = "block";
    document.getElementById("chatbot-boton").style.display = "none";

    if (esVistaMedico()) {
      mostrarPreguntas("medico");
      const paso1 = document.getElementById("paso1");
      const paso2 = document.getElementById("paso2");
      if (paso1) paso1.style.display = "none";
      if (paso2) paso2.style.display = "none";
    }
  }

  function cerrarChat() {
    document.getElementById("chatbot-contenedor").style.display = "none";
    document.getElementById("chatbot-boton").style.display = "flex";
    const paso1 = document.getElementById("paso1");
    const paso2 = document.getElementById("paso2");
    if (paso1) paso1.style.display = "block";
    if (paso2) paso2.style.display = "none";
    document.getElementById("preguntas-container").style.display = "none";
    document.getElementById("respuesta").classList.add("d-none");
  }

  function siguientePaso(paso) {
    if (esVistaMedico()) {
      mostrarPreguntas("medico");
      return;
    }
    document.getElementById("paso1").style.display = paso === 1 ? "block" : "none";
    document.getElementById("paso2").style.display = paso === 2 ? "block" : "none";
    document.getElementById("preguntas-container").style.display = "none";
    document.getElementById("respuesta").classList.add("d-none");
  }

  function mostrarPreguntas(tipo) {
    let preguntas;
    if (tipo === 'tutor') {
      preguntas = preguntasTutor;
    } else if (tipo === 'jugador') {
      preguntas = preguntasJugador;
    } else if (tipo === 'medico') {
      preguntas = preguntasMedico;
    } else {
      console.warn("Tipo de usuario no reconocido:", tipo);
      return;
    }

    const lista = document.getElementById("lista-preguntas");
    const titulo = document.getElementById("titulo-preguntas");
    const paso1 = document.getElementById("paso1");
    const paso2 = document.getElementById("paso2");
    const preguntasContainer = document.getElementById("preguntas-container");

    if (!lista || !titulo || !paso1 || !preguntasContainer) {
      console.error("Elementos del DOM no encontrados.");
      return;
    }

    lista.innerHTML = "";
    preguntas.forEach((item) => {
      const li = document.createElement("li");
      li.className = "list-group-item list-group-item-action";
      li.style.cursor = "pointer";
      li.textContent = item.q;
      li.onclick = () => mostrarRespuesta(item.r);
      lista.appendChild(li);
    });

    titulo.textContent =
      tipo === 'tutor' ? "Preguntas frecuentes para Tutores" :
      tipo === 'jugador' ? "Preguntas frecuentes para Jugadores" :
      "Preguntas frecuentes para M√©dicos";

    if (paso1) paso1.style.display = "none";
    if (paso2) paso2.style.display = "none";
    preguntasContainer.style.display = "block";
  }

  function mostrarRespuesta(texto) {
    const div = document.getElementById("respuesta");
    if (div) {
      div.textContent = texto;
      div.classList.remove("d-none");
    }
  }
  document.addEventListener("click", function (event) {
  const chatContenedor = document.getElementById("chatbot-contenedor");
  const chatBoton = document.getElementById("chatbot-boton");

  if (!chatContenedor || !chatBoton) return;

  // Si el clic fue fuera del chatbot y del bot√≥n flotante, cerrarlo
  if (!chatContenedor.contains(event.target) && !chatBoton.contains(event.target)) {
    if (chatContenedor.style.display === "block") {
      cerrarChat();
    }
  }
});
</script>


    
     

    


    <!-- Modal de confirmaci√≥n de cierre de sesi√≥n -->
    <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="logoutModalLabel">Cerrar Sesi√≥n</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    ¬øEst√°s seguro de que deseas cerrar sesi√≥n?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <form method="POST" action="/account/logout/" class="d-inline" id="logout-form">
                        <input type="hidden" name="csrfmiddlewaretoken" value="y38V7LGifoZahXk9PecmHOA6lfPSBpxpG64MTrMERbLfWd74ImreqUcdDdPv55ji">
                        <button type="submit" class="btn btn-danger">Cerrar Sesi√≥n</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Vendor JS Files -->
    <script src="/static/core/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/static/core/vendor/aos/aos.js"></script>
    <script src="/static/core/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="/static/core/vendor/swiper/swiper-bundle.min.js"></script>

    <!-- Main JS File -->

</body>

</html>
