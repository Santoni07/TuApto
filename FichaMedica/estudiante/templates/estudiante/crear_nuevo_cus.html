{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center text-primary mb-4">Estudiantes con CUS Vencido</h2>

    {% if estudiantes %}
        <table class="table table-bordered table-hover shadow-sm">
            <thead class="table-info text-center">
                <tr>
                    <th>Nombre</th>
                    <th>Apellido</th>
                    <th>DNI</th>
                    <th>Estado CUS</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody>
                {% for estudiante in estudiantes %}
                    {% with estudiante.cus.last as cus %}
                        {% if cus and cus.estado == 'VENCIDO' %}
                            <tr class="text-center">
                                <td>{{ estudiante.nombre }}</td>
                                <td>{{ estudiante.apellido }}</td>
                                <td>{{ estudiante.dni }}</td>
                                <td><span class="text-danger fw-bold">{{ cus.estado }}</span></td>
                                <td>
                                    <button class="btn btn-warning btn-sm" onclick="mostrarAlerta()">Actualizar</button>
                                </td>
                            </tr>
                        {% endif %}
                    {% endwith %}
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-center text-muted">No hay estudiantes con CUS vencido.</p>
    {% endif %}
</div>

<script>
    function mostrarAlerta() {
        alert("Para actualizar el CUS vencido, dirígete a 'Cargar Antecedentes' y selecciona el alumno.");
    }
</script>
{% endblock %}